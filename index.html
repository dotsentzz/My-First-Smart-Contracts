<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>LERA EMPIRE | ULTIMATE TERMINAL üëë</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.7.0/ethers.umd.min.js"></script>
    <style>
        :root {
            --main-pink: #ff00ff;
            --cyan: #00ffff;
        }

        body {
            background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
            color: white;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 0, 255, 0.3);
            border-radius: 30px;
            padding: 40px;
            width: 480px;
            text-align: center;
            box-shadow: 0 0 60px rgba(255, 0, 255, 0.2);
        }

        h1 {
            color: var(--main-pink);
            text-shadow: 0 0 15px var(--main-pink);
            letter-spacing: 2px;
        }

        .stat-card {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            border-left: 5px solid var(--cyan);
            text-align: left;
            transition: 0.3s;
        }

        button {
            width: 100%;
            padding: 15px;
            margin-top: 10px;
            border-radius: 50px;
            border: none;
            background: linear-gradient(45deg, var(--main-pink), #800080);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            box-shadow: 0 5px 15px rgba(255, 0, 255, 0.4);
            font-size: 16px;
        }

            button:hover {
                transform: scale(1.02);
                box-shadow: 0 0 30px var(--main-pink);
            }

        input {
            width: 90%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 10px;
            border: 1px solid var(--cyan);
            background: transparent;
            color: white;
            text-align: center;
        }

        span {
            font-weight: bold;
            color: var(--cyan);
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>EMPIRE HUB üëë</h1>

        <div class="stat-card">
            <p>üë§ OWNER: <span id="walletAddress">Not connected</span></p>
        </div>

        <div class="stat-card">
            <p>üíñ LOVELERA: <span id="tokenBalance">0.0</span></p>
            <p>üê∂ DIAPUPS NFT: <span id="nftBalance">0</span></p>
            <p>üè¶ BANK TOTAL: <span id="bankBalance">0.0</span> ETH</p>
        </div>

        <div class="stat-card">
            <h3>üè¶ BANK ACTIONS</h3>
            <input type="number" step="0.01" id="depositAmount" placeholder="ETH to deposit">
            <button onclick="depositEth()">DEPOSIT ETH TO BANK</button>
        </div>

        <button onclick="init()" style="background: #333; margin-top: 20px;">REFRESH DATA</button>
    </div>

    <script>
        const LERA_ADDR = "0x77A2cE332F686713C96a0129E5EbEF6552f80f5f";
        const BANK_ADDR = "0x917986406b8cff0BA2eb5E35c770E3749Adae790";
        const NFT_ADDR = "0x811F43828b100037C9a56682EeAB007173a55dAA";

        const LERA_ABI = ["function balanceOf(address) view returns (uint256)", "function decimals() view returns (uint8)"];

        // –†–∞—Å—à–∏—Ä—è–µ–º ABI –¥–ª—è NFT, —á—Ç–æ–±—ã –¥–æ—Å—Ç–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É
        const NFT_ABI = [
            "function balanceOf(address) view returns (uint256)",
            "function tokenOfOwnerByIndex(address owner, uint256 index) view returns (uint256)",
            "function tokenURI(uint256 tokenId) view returns (string)"
        ];

        const BANK_ABI = [
            "function getBalance() view returns (uint256)",
            "function deposit() payable"
        ];

        async function init() {
            if (!window.ethereum) return alert("Install MetaMask!");

            try {
                const provider = new ethers.BrowserProvider(window.ethereum);
                const signer = await provider.getSigner();
                const address = await signer.getAddress();
                document.getElementById('walletAddress').innerText = address.slice(0, 6) + "..." + address.slice(-4);

                // 1. –ë–∞–ª–∞–Ω—Å LOVELERA
                const leraContract = new ethers.Contract(LERA_ADDR, LERA_ABI, provider);
                const leraBal = await leraContract.balanceOf(address);
                document.getElementById('tokenBalance').innerText = ethers.formatUnits(leraBal, 18) + " LERA";

                // 2. –ë–∞–ª–∞–Ω—Å –ë–ê–ù–ö–ê
                const bankContract = new ethers.Contract(BANK_ADDR, BANK_ABI, provider);
                const bankBal = await bankContract.getBalance();
                document.getElementById('bankBalance').innerText = ethers.formatEther(bankBal);

                // 3. –ü–û–ö–ê–ó–´–í–ê–ï–ú NFT –° –ö–ê–†–¢–ò–ù–ö–ê–ú–ò
                const nftContract = new ethers.Contract(NFT_ADDR, NFT_ABI, provider);
                const nftBal = await nftContract.balanceOf(address);
                document.getElementById('nftBalance').innerText = nftBal.toString() + " PUPS";

                // –°—é–¥–∞ –±—É–¥–µ–º –¥–æ–±–∞–≤–ª—è—Ç—å –∫–∞—Ä—Ç–∏–Ω–∫–∏
                const nftGallery = document.getElementById('nftGallery');
                if (nftGallery) nftGallery.innerHTML = ""; // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ

                // –ï—Å–ª–∏ —É —Ç–µ–±—è –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ –Ω–µ—Ç tokenOfOwnerByIndex, –º—ã –ø—Ä–æ—Å—Ç–æ –ø–æ–ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—É—é
                if (nftBal > 0n) {
                    // –î–ª—è —Ç–µ—Å—Ç–∞ –∑–∞–≥—Ä—É–∑–∏–º –∫–∞—Ä—Ç–∏–Ω–∫—É –ø–µ—Ä–≤–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ (–æ–±—ã—á–Ω–æ ID 1 –∏–ª–∏ 0)
                    try {
                        const uri = await nftContract.tokenURI(1); // –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É —Ç–µ–±—è ID 1
                        const imgUrl = uri.replace("ipfs://", "https://ipfs.io/ipfs/");

                        const img = document.createElement('img');
                        img.src = imgUrl;
                        img.style.width = "100px";
                        img.style.borderRadius = "10px";
                        img.style.marginTop = "10px";
                        img.style.border = "2px solid #ff00ff";
                        document.querySelector('.stat-card:nth-child(2)').appendChild(img);
                    } catch (e) { console.log("Can't find image for token 1"); }
                }

            } catch (e) {
                console.error(e);
            }
        }
        async function depositEth() {
            const amount = document.getElementById('depositAmount').value;
            if (!amount || amount <= 0) return alert("How much ETH, babe?");

            const provider = new ethers.BrowserProvider(window.ethereum);
            const signer = await provider.getSigner();
            const bankContract = new ethers.Contract(BANK_ADDR, BANK_ABI, signer);

            try {
                alert("Sending ETH to your Royal Bank...");
                const tx = await bankContract.deposit({ value: ethers.parseEther(amount) });
                await tx.wait();
                alert("SUCCESS! The vault is full! üíé");
                init();
            } catch (e) {
                alert("Error: " + e.message);
            }
        }
    </script>
</body>
</html>